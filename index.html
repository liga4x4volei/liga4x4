<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üèê Liga 4x4 ‚Äì Classifica√ß√£o e Jogos</title>

<style>
body{
  font-family:Arial,sans-serif;
  background:linear-gradient(90deg,#004aad,#8ba9d1);
  margin:0;
  padding:10px;
}
h1,h2{color:#fff;text-align:center}

.proximos-jogos{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:15px;
  margin:15px 0 25px;
}
.proximo-card{
  background:#fff;
  border-left:6px solid #c40000;
  padding:12px;
  border-radius:10px;
}
.confronto{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  font-size:18px;
  font-weight:bold;
}
.confronto img{
  width:32px;
  height:32px;
  object-fit:contain;
}

table{
  width:100%;
  background:#fff;
  border-collapse:collapse;
}
th,td{
  border:1px solid #ddd;
  padding:8px;
  text-align:center;
}
th{background:#111;color:#fff}
.classificado{background:#c40000;color:#fff;font-weight:bold}

.time-cell{
  display:flex;
  align-items:center;
  gap:6px;
  justify-content:center;
}
.time-cell img{width:36px;height:36px}

.jogos{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:12px;
}
.jogo{
  background:#fff;
  padding:12px;
  border-radius:10px;
}
.times{
  display:flex;
  justify-content:space-between;
  font-weight:bold;
}
.time{
  display:flex;
  align-items:center;
  gap:6px;
}
.time img{width:30px;height:30px}

.set{text-align:center}
.placar{display:flex;gap:5px;justify-content:center}
input{width:45px;text-align:center}

button{
  position:fixed;
  bottom:15px;
  right:15px;
  padding:12px 18px;
}
@media(max-width:700px){
  .proximos-jogos,.jogos{grid-template-columns:1fr}
}
</style>
</head>

<body>

<h1>üèê Liga 4x4</h1>

<div class="proximos-jogos" id="proximos"></div>

<h2>üèÜ Classifica√ß√£o</h2>
<table>
<thead>
<tr><th>Pos</th><th>Time</th><th>J</th><th>Sets+</th><th>Saldo</th><th>Vit</th></tr>
</thead>
<tbody id="classificacao"></tbody>
</table>

<h2>üìã Jogos</h2>
<div class="jogos" id="jogos"></div>

<button onclick="toggleAdmin()">ADMIN</button>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyCovHcUFKP9dtwRxfnajhvGUgluCFp0HVQ",
  authDomain: "liga4x4volei-71358.firebaseapp.com",
  projectId: "liga4x4volei-71358"
});
const db=firebase.firestore();
const REF=db.collection("liga4x4").doc("dados");

const TIMES=[...Array(12)].map((_,i)=>`t${i+1}`);
let nomesTimes={},logosTimes={},jogos=[],isAdmin=false;

let proximosJogos={
  p1:{data:"",local:"",a:"t1",b:"t2"},
  p2:{data:"",local:"",a:"t3",b:"t4"}
};

TIMES.forEach((t,i)=>{
  nomesTimes[t]=`Time ${i+1}`;
  logosTimes[t]="";
});

function toggleAdmin(){
  if(prompt("Senha:")==="liga4x4"){isAdmin=!isAdmin;render();}
}

function criarJogos(){
  jogos=[];
  for(let i=0;i<TIMES.length;i++)
    for(let j=i+1;j<TIMES.length;j++)
      jogos.push({a:TIMES[i],b:TIMES[j],sets:{s1:{a:null,b:null},s2:{a:null,b:null},s3:{a:null,b:null}}});
}

async function salvar(){
  await REF.set({nomesTimes,logosTimes,jogos,proximosJogos},{merge:true});
}

function renderProximos(){
  const div=document.getElementById("proximos");
  div.innerHTML="";
  Object.entries(proximosJogos).forEach(([k,p],i)=>{
    div.innerHTML+=`
    <div class="proximo-card">
      <h3>${i==0?"üîú Pr√≥ximo Jogo":"‚è≠Ô∏è Jogo Seguinte"}</h3>
      ${isAdmin?`
        <input placeholder="Data" value="${p.data}" oninput="proximosJogos.${k}.data=this.value;salvar()">
        <input placeholder="Local" value="${p.local}" oninput="proximosJogos.${k}.local=this.value;salvar()">
      `:`<p><strong>${p.data}</strong><br>${p.local}</p>`}
      <div class="confronto">
        ${logosTimes[p.a]?`<img src="${logosTimes[p.a]}">`:``}
        ${nomesTimes[p.a]}
        x
        ${nomesTimes[p.b]}
        ${logosTimes[p.b]?`<img src="${logosTimes[p.b]}">`:``}
      </div>
    </div>`;
  });
}

function renderClassificacao(){
  const stats={};
  TIMES.forEach(t=>stats[t]={j:0,sets:0,saldo:0,vit:0});
  jogos.forEach(j=>{
    let sa=0,sb=0,r=false;
    Object.values(j.sets).forEach(s=>{
      if(s.a!=null&&s.b!=null){
        r=true;
        if(s.a>s.b){sa++;stats[j.a].sets++;stats[j.a].saldo++;stats[j.b].saldo--;}
        else{sb++;stats[j.b].sets++;stats[j.b].saldo++;stats[j.a].saldo--;}
      }
    });
    if(r){stats[j.a].j++;stats[j.b].j++;}
    if(sa>=2)stats[j.a].vit++;
    if(sb>=2)stats[j.b].vit++;
  });
  document.getElementById("classificacao").innerHTML=
    Object.entries(stats).sort(([,a],[,b])=>b.sets-a.sets||b.saldo-a.saldo)
    .map(([id,s],i)=>`
      <tr class="${i<4?'classificado':''}">
        <td>${i+1}</td>
        <td class="time-cell">${logosTimes[id]?`<img src="${logosTimes[id]}">`:``}${nomesTimes[id]}</td>
        <td>${s.j}</td><td>${s.sets}</td><td>${s.saldo}</td><td>${s.vit}</td>
      </tr>`).join("");
}

function renderJogos(){
  document.getElementById("jogos").innerHTML=jogos.map((j,i)=>`
    <div class="jogo">
      <h3>Jogo ${i+1}</h3>
      <div class="times">
        <div class="time">${logosTimes[j.a]?`<img src="${logosTimes[j.a]}">`:``}${nomesTimes[j.a]}</div>
        <div class="time">${logosTimes[j.b]?`<img src="${logosTimes[j.b]}">`:``}${nomesTimes[j.b]}</div>
      </div>
    </div>`).join("");
}

function render(){
  renderProximos();
  renderClassificacao();
  renderJogos();
}

async function iniciar(){
  const s=await REF.get();
  if(s.exists){
    const d=s.data();
    nomesTimes=d.nomesTimes||nomesTimes;
    logosTimes=d.logosTimes||logosTimes;
    jogos=d.jogos||[];
    proximosJogos=d.proximosJogos||proximosJogos;
  }
  if(!jogos.length){criarJogos();salvar();}
  render();
}
iniciar();
</script>

</body>
</html>
